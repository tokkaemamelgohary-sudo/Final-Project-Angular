<section class="bg-gray-200 p-4 mt-20">
  <div class="container">
    <div class="parent grid sm:grid-cols-12 gap-10">
      <div class="col-span-12">
        <div class="bg-gray-200 p-4 shadow rounded-lg">
          
          <div class="flex flex-wrap gap-3 mb-3">
            <div class="flex justify-between items-center mb-3 w-full">
              <h1 class="text-2xl font-semibold text-gray-800">All Orders</h1>
              
              @if (ordersData().length > 0) {
                <button 
                  (click)="clearAllOrders()" 
                  class="text-2xl cursor-pointer text-black" 
                  title="Clear all orders"
                >
 <i class="fas fa-times"></i>               
 </button>
              }
            </div>
            
            @if (isLoading()) {
              <div class="w-full flex justify-center items-center py-12">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"></div>
              </div>
            }
            
            @else if (ordersData().length === 0) {
              <div class="w-full text-center py-12">
                <i class="fas fa-box-open text-6xl text-gray-400 mb-4"></i>
                <h3 class="text-xl text-gray-600 mb-2">No Orders Yet</h3>
                <p class="text-gray-500">You haven't placed any orders yet</p>
              </div>
            }
            
            @else {
              <div class="w-full">
                <span class="text-xl text-gray-700">{{ ordersData().length }} Orders</span>
              </div>
            }

            @for (order of ordersData(); track order._id) {
              <div class="w-full bg-white p-4 shadow rounded-lg mb-3">
                
                <div class="flex justify-between items-center mb-4 pb-3 border-b border-gray-200">
                  <div>
                    <h3 class="text-lg font-semibold text-gray-800">Order #{{ order.id }}</h3>
                    <p class="text-sm text-gray-500">{{ formatDate(order.createdAt) }}</p>
                  </div>
                  <div class="text-right">
                    <span 
                      class="px-3 py-1 rounded-full text-sm font-medium"
                      [ngClass]="getStatusClasses(order.isPaid, order.isDelivered)"
                    >
                      {{ getStatusText(order.isPaid, order.isDelivered) }}
                    </span>
                  </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4 pb-4 border-b border-gray-200">
                  
                  <div class="flex items-center gap-2">
                    <i [class]="getPaymentIcon(order.paymentMethodType)" class="text-green-600 text-xl"></i>
                    <div>
                      <p class="text-xs text-gray-500">Payment Method</p>
                      <p class="font-medium text-gray-800">{{ order.paymentMethodType }}</p>
                    </div>
                  </div>

                  <div class="flex items-center gap-2">
                    <i class="fas fa-wallet text-blue-600 text-xl"></i>
                    <div>
                      <p class="text-xs text-gray-500">Payment Status</p>
                      <p class="font-medium" [class.text-green-600]="order.isPaid" [class.text-yellow-600]="!order.isPaid">
                        {{ order.isPaid ? 'Paid' : 'Not Paid' }}
                      </p>
                    </div>
                  </div>

                  <div class="flex items-center gap-2">
                    <i class="fas fa-truck text-purple-600 text-xl"></i>
                    <div>
                      <p class="text-xs text-gray-500">Delivery Status</p>
                      <p class="font-medium" [class.text-green-600]="order.isDelivered" [class.text-blue-600]="!order.isDelivered">
                        {{ order.isDelivered ? 'Delivered' : 'In Transit' }}
                      </p>
                    </div>
                  </div>
                </div>

                <div class="bg-gray-50 p-3 rounded-lg mb-4">
                  <div class="flex items-start gap-2">
                    <i class="fas fa-map-marker-alt text-red-500 mt-1"></i>
                    <div>
                      <p class="text-xs text-gray-500 mb-1">Shipping Address</p>
                      <p class="text-sm text-gray-700">{{ order.shippingAddress.details }}</p>
                      <p class="text-sm text-gray-700">{{ order.shippingAddress.city }}</p>
                      <p class="text-sm text-gray-700">Phone: {{ order.shippingAddress.phone }}</p>
                    </div>
                  </div>
                </div>

                <div class="mb-4">
                  <h4 class="text-sm font-semibold text-gray-700 mb-3">Order Items</h4>
                  
                  @for (item of order.cartItems; track item._id) {
                    <div class="parent gap-2 grid sm:grid-cols-12 bg-gray-50 p-3 rounded-lg mb-2">
                      
                      <div class="col-span-12 sm:col-span-2">
                        <img 
                          [src]="item.product.imageCover" 
                          [alt]="item.product.title"
                          class="w-full h-20 object-cover rounded-md"
                        >
                      </div>

                      <div class="col-span-12 sm:col-span-10 flex justify-between items-center">
                        <div class="flex flex-col gap-1">
                          <h3 class="text-base font-medium text-gray-800">{{ item.product.title }}</h3>
                          <p class="text-sm text-gray-600">Quantity: {{ item.count }}</p>
                          <p class="text-green-600 font-semibold">{{ item.price | currency:'EGP':'symbol' }} each</p>
                        </div>

                        <div class="self-center text-right">
                          <p class="text-xs text-gray-500">Subtotal</p>
                          <p class="text-lg font-bold text-gray-800">{{ (item.price * item.count) | currency:'EGP':'symbol' }}</p>
                        </div>
                      </div>
                    </div>
                  }
                </div>

                <div class="bg-green-50 p-4 rounded-lg">
                  <div class="flex justify-between items-center">
                    <div>
                      <p class="text-sm text-gray-600">Total Order Price</p>
                      @if (order.taxPrice > 0) {
                        <p class="text-xs text-gray-500">Including Tax: {{ order.taxPrice | currency:'EGP':'symbol' }}</p>
                      }
                      @if (order.shippingPrice > 0) {
                        <p class="text-xs text-gray-500">Shipping: {{ order.shippingPrice | currency:'EGP':'symbol' }}</p>
                      }
                    </div>
                    <div class="text-right">
                      <p class="text-2xl font-bold text-green-600">{{ order.totalOrderPrice | currency:'EGP':'symbol' }}</p>
                    </div>
                  </div>
                </div>

              </div>
            }
          </div>
        </div>
      </div>
    </div>
  </div>
</section>